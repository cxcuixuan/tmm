s  = redcross(redcross(s3,s1),s2);
sa = redcross(s3,redcross(s1,s2));


S11_g = s1(1:2,1:2) ; S12_g = s1(1:2,3:4); 
S21_g = s1(3:4,1:2) ; S22_g = s1(3:4,3:4); 

S11_d = s2(1:2,1:2) ; S12_d = s2(1:2,3:4); 
S21_d = s2(3:4,1:2) ; S22_d = s2(3:4,3:4); 

upd_smatrix;

S11_d = S11_g ; S12_d = S12_g; 
S21_d = S21_g ; S22_d = S22_g; 

S11_g = s3(1:2,1:2) ; S12_g = s3(1:2,3:4); 
S21_g = s3(3:4,1:2) ; S22_g = s3(3:4,3:4) ;
upd_smatrix;
S1 = [S11_g S12_g;S21_g S22_g];
% 
% -----------------------------------------------------%
% 
% S11_g = S_g(1:2,1:2) ; S12_g = S_g(1:2,3:4); 
% S21_g = S_g(3:4,1:2) ; S22_g = S_g(3:4,3:4) ;
% 
% S11_d = S_d1(1:2,1:2) ; S12_d = S_d1(1:2,3:4); 
% S21_d = S_d1(3:4,1:2) ; S22_d = S_d1(3:4,3:4) ; 
% 
% upd_smatrix;
% 
% S11_d = S_d2(1:2,1:2) ; S12_d = S_d2(1:2,3:4); 
% S21_d = S_d2(3:4,1:2) ; S22_d = S_d2(3:4,3:4) ; 
% 
% upd_smatrix;
% S = [S11_g S12_g;S21_g S22_g];